function Con_table=Con_tab(E,EC,U,Rule)
% 控制表的计算函数
E=[1.0 0.8 0.7 0.4 0.1 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
   0.2 0.7 1.0 0.7 0.3 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
   0.0 0.1 0.3 0.7 1.0 0.7 0.2 0.0 0.0 0.0 0.0 0.0 0.0
   0.0 0.0 0.0 0.0 0.1 0.6 1.0 0.0 0.0 0.0 0.0 0.0 0.0
   0.0 0.0 0.0 0.0 0.0 0.0 1.0 0.6 0.1 0.0 0.0 0.0 0.0
   0.0 0.0 0.0 0.0 0.0 0.0 0.2 0.7 1.0 0.7 0.3 0.1 0.0
   0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.2 0.7 1.0 0.7 0.3
   0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.1 0.4 0.7 0.8 1.0];

EC=[1.0 0.7 0.3 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
    0.3 0.7 1.0 0.7 0.3 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
    0.0 0.0 0.3 0.7 1.0 0.7 0.3 0.0 0.0 0.0 0.0 0.0 0.0
    0.0 0.0 0.0 0.0 0.3 0.7 1.0 0.7 0.3 0.0 0.0 0.0 0.0
    0.0 0.0 0.0 0.0 0.0 0.0 0.3 0.7 1.0 0.7 0.3 0.0 0.0
    0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.3 0.7 1.0 0.7 0.3
    0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.3 0.7 1.0];

U=EC;

Rule=[1 1 1 1 2 4 4
      1 1 1 1 2 4 4
      2 2 2 2 4 5 5
      2 2 3 4 5 6 6
      2 2 3 4 5 6 6
      3 3 4 6 6 6 6
      4 4 6 7 7 7 7
      4 4 6 7 7 7 7];
  
 
E_size = size(E);
EC_size = size(EC);
U_size = size(U);
for m = 1 : 1 : E_size(2)
    A(1:1:E_size(2))=0;
    A(m)=1;
    for n = 1 : 1 : EC_size(2)
       C(1:1:EC_size(2))=0;
       C(n)=1;
       max_unit(1:1:U_size(2))=0;
        for i = 1 : 1 : E_size(1)
            B=E(i,:);
            for j = 1 : 1 : EC_size(1)
                D=EC(j,:);
                F=U(Rule(i,j),:);
                G=Unit(A,B,C,D,F);
                max_unit=A_bing_B(max_unit,G);
            end
        end
        Con_table(m,n)=balance_1(max_unit);
    end
end
    
                       

        